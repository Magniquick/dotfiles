#!/usr/bin/env bash
eww="$HOME/.config/eww/scripts"
eww_powermenu_selected_action="$(eww get powermenu-button-selected)"


if [[ -z "$1" ]]; then
    echo You did not specify an action
    exit 1
fi

action=$1

poweroff() {
    systemctl poweroff
}

reboot() {
    systemctl reboot
}

suspend() {
    "${eww}/manage" hide powermenu
    systemctl suspend
}

hibernate() {
    "${eww}/manage" hide powermenu
    systemctl hibernate
}

exit() {
    "${eww}/manage" hide powermenu
    loginctl lock-session
}

lock() {
    systemctl reboot --boot-loader-entry=auto-windows
}

# Double-clicking the same action executes it; first click just selects.
if [[ "$action" == "$eww_powermenu_selected_action" ]]; then
    $action
else
    eww update powermenu-button-selected="$action"
fi
